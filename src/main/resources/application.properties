# Dialtone Protocol Server Configuration
server.port=5191
verbose=true
bind.address=0.0.0.0

# Web Interface Configuration
web.port=5200
web.bind.address=0.0.0.0

# Database Configuration
db.path=db/dialtone.db
db.pool.max.size=10
db.pool.min.idle=2
db.connection.timeout=30000

# X OAuth Configuration (REQUIRED for web interface)
# Get these from your X Developer account at https://developer.x.com/
x.oauth.client.id=
x.oauth.client.secret=
x.oauth.redirect.uri=http://localhost:5200/api/auth/x/callback

# Discord OAuth Configuration
# Get these from your Discord Developer Portal at https://discord.com/developers/applications
discord.oauth.client.id=
discord.oauth.client.secret=
discord.oauth.redirect.uri=http://localhost:5200/api/auth/discord/callback

# Web Session Configuration
session.timeout.minutes=1440
jwt.secret=
jwt.expiry.hours=24

# Development Configuration
development.mode=false
cors.allowed.origins=http://localhost:3000,http://localhost:5173,http://localhost:5200

# Authentication Configuration
# Database-only authentication - all users must be created via web interface
auth.mode=database

# FDO Compiler Configuration
# Uses native atomforge-fdo Java library for compilation
fdo.compiler.backend=java

# P3 Frame Configuration
# Maximum frame length on the wire (as seen in wiretap)
# Default: 194 bytes
p3.max.frame.length=512

# P3 Pacer Configuration
# Inter-frame delay in milliseconds (0 = disabled, recommended: 5-10 for slow clients)
# Helps prevent Mac client crashes on second connect by pacing IDB frame bursts
pacer.inter.frame.delay.ms=0


# Grok AI API configuration
# GLOBAL KILL SWITCH - Set to false to disable ALL Grok API calls (uses cached content only)
grok.enabled=true
grok.api.key=
grok.base.url=https://api.x.ai/v1
grok.model=grok-4-fast
grok.timeout.ms=180000
grok.refresh.interval.minutes=1440
grok.retry.enabled=false
grok.retry.delay.seconds=50

# Daily API quota (max fetches per 24 hours across all services)
# Prevents burning through API credits on server restarts
grok.daily.quota=10

# Grok Search Tools configuration (web_search, x_search via Responses API)
grok.search.enabled=true
grok.search.sources=web_search,x_search

# Story formatting configuration (applies to ALL news categories)
# Adjust these values to control story detail/length globally
grok.story.summary.sentences=4
grok.story.headline.words.min=12
grok.story.headline.words.max=18

# Unified News Service Configuration
# Base directory for all news persistence (categories go in subdirs: news/general, news/crypto, etc.)
news.base.persist.dir=storage/news

# Default settings for all categories (can be overridden per category)
news.default.refresh.interval.minutes=1440
news.default.daily.quota=10
news.default.keep.count=10

# Per-category overrides (only specify if different from defaults)
# General news refreshes more frequently
news.general.refresh.interval.minutes=30

# All other categories use the defaults above (crypto, sports, entertainment, tech)

# Grok Conversational AI (Grok chatbot)
grok.chat.max.tokens=1000
grok.chat.temperature=0.8
grok.chat.system.prompt=You are Grok, a friendly and knowledgeable AI assistant from the classic instant messenger era. \
You are helpful, conversational, and have a warm personality. \
Give complete, helpful answers - your responses will be automatically split into multiple chat messages. \
Use short sentences that flow naturally. Avoid bullet points, numbered lists, or markdown formatting. \
Write like you are chatting with a friend - conversational and warm. \
IMPORTANT: Never use emojis or non-ASCII characters in your responses. \
This is a 1995 ASCII-only protocol that cannot handle emojis. \
Use plain text only with standard punctuation.

# Chat Bot Registry configuration
# Timeout for bot responses (must accommodate AI API latency)
# Grok API can take 30+ seconds for complex responses, so use generous timeout
# Increased to 120s to accommodate: initial response (~60s) + AI splitting (~60s)
bot.response.timeout.ms=120000

# Response Formatter Configuration
# Controls how Grok bot responses are formatted to fit AOL protocol limits
# Character limits per context (based on AOL client display constraints)
formatter.chat.room.limit=68
formatter.im.limit=512
# Delay between split messages (milliseconds) - makes multi-part responses feel natural
formatter.split.delay.ms=500
# Enable AI-powered message splitting (uses extra API call to split naturally)
# When false, falls back to deterministic word-boundary splitting with truncation
formatter.ai.splitting.enabled=true
# Maximum number of messages to send per response (prevents chat/IM window flooding)
formatter.max.messages=10

# Admin System Configuration
# FEATURE FLAG - Set to true to enable admin features (default: false for safety)
admin.enabled=false

# List of X/Twitter usernames that get admin privileges
# Format: comma-separated list of X usernames (case-sensitive)
admin.x.usernames=

# Auto-promote configured users to admin role on login
admin.auto.promote=true

# Admin-specific limits and settings
admin.max.screennames.override=20
admin.session.timeout.minutes=30

# Admin security settings
admin.require.confirmation.for.destructive.actions=true
admin.rate.limit.requests.per.minute=60

# Admin audit log settings
admin.audit.log.retention.days=365
admin.audit.log.max.entries=100000

# Email Authentication (Resend Magic Link)
email.enabled=true
email.resend.api.key=
email.from.address=support@dialtone.live
email.from.name=Dialtone
email.magic.link.expiry.minutes=15
email.base.url=http://localhost:5200
email.rate.limit.per.hour=3

# File Transfer Configuration
# Maximum file size for web-to-AOL transfers (in MB)
transfer.max.file.size.mb=10

# Storage Abstraction Layer Configuration
# Type: local (default) - uses filesystem with JSON metadata sidecars
# Future: s3, api, etc.
storage.type=local
# Base directory for all file storage (uploads and downloads)
# Structure: storage/user/{screenname}/ for uploads, storage/global/ for downloads
storage.local.base.dir=storage
# Maximum file size in MB
storage.local.max.file.size.mb=10

# Button Theming (Dialtone Brand Colors)
# Customize button appearance across all FDO interfaces
button.color.face=252, 157, 44
button.color.text=0, 30, 55
button.color.top.edge=255, 200, 100
button.color.bottom.edge=150, 90, 20

# XFER Upload Configuration (client to server uploads)
# Timeout waiting for each protocol phase (in milliseconds)
# File selection phase needs longer timeout for user to browse and pick a file
upload.phase.timeout.ms=300000

# Upload Flow Control Configuration
# Both can be enabled simultaneously for testing different combinations
# Enable tN token optimization (experimental)
upload.tn.enabled=false
# tN interval: Send tN every N frames (6 = before 8-frame burst ends for overlap)
upload.tn.interval.frames=6
# Enable proactive 0x24 ACK (stable Windows behavior)
upload.ack.enabled=true
# Proactive ACK interval: Send 0x24 ACK every N frames
upload.ack.interval.frames=8

# Skalholt Telnet Bridge Configuration
# Host and port for the telnet server that Skalholt connects to
telnet.host=localhost
telnet.port=8162
telnet.timeout.ms=30000

# Skalholt MUD API Configuration
# Enables integration with Skalholt HTTP API for game state events
skalholt.api.host=localhost
skalholt.api.port=8163
skalholt.api.timeout.ms=10000
skalholt.eventstream.enabled=true

# Skalholt SSO Configuration
# Shared secret for bannerless telnet authentication
# Format sent to server: AUTH <base64(username:password)> <secret>
skalholt.sso.secret=

# Ephemeral Guest Fallback Configuration
# When enabled, failed authentication attempts create ephemeral guest sessions
# instead of returning an error. Guest names are auto-generated (~GuestXXXX)
# and cleaned up on disconnect. This replaces the old auth.pass.through mode.
auth.ephemeral.fallback.enabled=true
